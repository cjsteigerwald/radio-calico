#!/bin/bash

# Git secrets patterns to detect
# This file defines patterns that should never be committed

# AWS Keys
aws[_\-]?access[_\-]?key[_\-]?id
aws[_\-]?secret[_\-]?access[_\-]?key
AKIA[0-9A-Z]{16}

# API Keys
api[_\-]?key
apikey
api[_\-]?secret

# Private Keys
-----BEGIN RSA PRIVATE KEY-----
-----BEGIN DSA PRIVATE KEY-----
-----BEGIN EC PRIVATE KEY-----
-----BEGIN OPENSSH PRIVATE KEY-----
-----BEGIN PGP PRIVATE KEY BLOCK-----

# Passwords
password\s*=\s*["\'][^"\']+["\']
passwd\s*=\s*["\'][^"\']+["\']
pwd\s*=\s*["\'][^"\']+["\']

# Database URLs with credentials
(mongodb|postgres|postgresql|mysql):\/\/[^:]+:[^@]+@

# JWT Secrets
jwt[_\-]?secret
jwt[_\-]?key

# OAuth
client[_\-]?secret
client[_\-]?id

# Google API Keys
AIza[0-9A-Za-z\-_]{35}
[0-9]+-[0-9A-Za-z_]{32}\.apps\.googleusercontent\.com

# Slack Tokens
xox[baprs]-[0-9]{12}-[0-9]{12}-[0-9a-zA-Z]{24}
https://hooks\.slack\.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24}

# GitHub Tokens
ghp_[0-9a-zA-Z]{36}
gho_[0-9a-zA-Z]{36}
github_pat_[0-9a-zA-Z]{22}_[0-9a-zA-Z]{59}

# Stripe Keys
sk_live_[0-9a-zA-Z]{24}
rk_live_[0-9a-zA-Z]{24}
pk_live_[0-9a-zA-Z]{24}

# SendGrid
SG\.[0-9A-Za-z\-_]{22}\.[0-9A-Za-z\-_]{43}

# Twilio
SK[0-9a-fA-F]{32}
AC[a-zA-Z0-9_\-]{32}

# Generic Secrets
secret[_\-]?key
private[_\-]?key
encryption[_\-]?key

# Tokens
[a-z0-9]{32,45}@[a-z]{2,20}\.[a-z]{2,10}
token\s*=\s*["\'][^"\']+["\']
auth[_\-]?token
bearer\s+[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+

# Credit Cards
\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12})\b