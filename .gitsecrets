#!/bin/bash

# Git secrets patterns to detect
# This file defines patterns that should never be committed

# AWS Keys
aws[_\-]?access[_\-]?key[_\-]?id
aws[_\-]?secret[_\-]?access[_\-]?key
AKIA[0-9A-Z]{16}

# API Keys
api[_\-]?key
apikey
api[_\-]?secret

# Private Keys
-----BEGIN RSA PRIVATE KEY-----
-----BEGIN DSA PRIVATE KEY-----
-----BEGIN EC PRIVATE KEY-----
-----BEGIN OPENSSH PRIVATE KEY-----
-----BEGIN PGP PRIVATE KEY BLOCK-----

# Passwords
password\s*=\s*["\'][^"\']+["\']
passwd\s*=\s*["\'][^"\']+["\']
pwd\s*=\s*["\'][^"\']+["\']

# Database URLs with credentials
(mongodb|postgres|postgresql|mysql):\/\/[^:]+:[^@]+@

# JWT Secrets
jwt[_\-]?secret
jwt[_\-]?key

# OAuth
client[_\-]?secret
client[_\-]?id

# Generic Secrets
secret[_\-]?key
private[_\-]?key
encryption[_\-]?key

# Tokens
[a-z0-9]{32,45}@[a-z]{2,20}\.[a-z]{2,10}
token\s*=\s*["\'][^"\']+["\']
auth[_\-]?token

# Credit Cards
\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12})\b